let e;function t(e){return e&&e.__esModule?e.default:e}var n,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},a={},o=r.parcelRequire94c2;null==o&&((o=function(e){if(e in i)return i[e].exports;if(e in a){var t=a[e];delete a[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},r.parcelRequire94c2=o);var l=o.register;l("kyEFX",function(e,t){Object.defineProperty(e.exports,"register",{get:function(){return n},set:function(e){return n=e},enumerable:!0,configurable:!0});var n,r=new Map;n=function(e,t){for(var n=0;n<t.length-1;n+=2)r.set(t[n],{baseUrl:e,path:t[n+1]})}}),l("jeOj9",function(e,t){var n=o("cbqHM"),r=o("dK39v"),i=o("5GDNt"),a=o("7s7aV"),l=o("1l1Xh");e.exports=function(e){function t(t,n,o){-1!==i.indexOf(t)&&(n.namespace="http://www.w3.org/2000/svg");var s,u=!1;n.namespace&&(u=n.namespace,delete n.namespace);var c=!1;if(n.is&&(c=n.is,delete n.is),u)s=c?e.createElementNS(u,t,{is:c}):e.createElementNS(u,t);else{if("!--"===t)return e.createComment(n.comment);s=c?e.createElement(t,{is:c}):e.createElement(t)}for(var m in n)if(n.hasOwnProperty(m)){var d=m.toLowerCase(),p=n[m];if("classname"===d&&(d="class",m="class"),"htmlFor"===m&&(m="for"),-1!==a.indexOf(d)){if("true"===String(p))p=d;else if("false"===String(p))continue}"on"===d.slice(0,2)||-1!==l.indexOf(d)?s[m]=p:u?"xlink:href"===m?s.setAttributeNS("http://www.w3.org/1999/xlink",m,p):/^xmlns($|:)/i.test(m)||s.setAttributeNS(null,m,p):s.setAttribute(m,p)}return r(s,o),s}var o=n(t,{comments:!0,createFragment:function t(n){for(var r=e.createDocumentFragment(),i=0;i<n.length;i++)null!=n[i]&&(Array.isArray(n[i])?r.appendChild(t(n[i])):("string"==typeof n[i]&&(n[i]=e.createTextNode(n[i])),r.appendChild(n[i])));return r}});return o.default=o,o.createComment=t,o}}),l("cbqHM",function(e,t){var n=o("3Hulk");e.exports=function(e,t){t||(t={});var i=t.concat||function(e,t){return String(e)+String(t)};return!1!==t.attrToProp&&(e=n(e)),function(n){for(var o=1,l="",s=arguments.length,u=[],c=0;c<n.length;c++)if(c<s-1){var m=arguments[c+1],d=N(n[c]),p=o;10===p&&(p=8),9===p&&(p=8),7===p&&(p=8),4===p&&(p=5),2===p?"/"===l?(d.push([2,"/",m]),l=""):d.push([2,m]):13===p&&t.comments?l+=String(m):13!==p&&d.push([0,p,m]),u.push.apply(u,d)}else u.push.apply(u,N(n[c]));for(var f=[null,{},[]],h=[[f,-1]],c=0;c<u.length;c++){var g,E=h[h.length-1][0],d=u[c],_=d[0];if(2===_&&/^\//.test(d[1])){var b=h[h.length-1][1];h.length>1&&(h.pop(),h[h.length-1][0][2][b]=e(E[0],E[1],E[2].length?E[2]:void 0))}else if(2===_){var y=[d[1],{},[]];E[2].push(y),h.push([y,E[2].length-1])}else if(5===_||0===_&&5===d[1]){for(var v,T="";c<u.length;c++)if(5===u[c][0])T=i(T,u[c][1]);else if(0===u[c][0]&&5===u[c][1]){if("object"!=typeof u[c][2]||T)T=i(T,u[c][2]);else for(v in u[c][2])u[c][2].hasOwnProperty(v)&&!E[1][v]&&(E[1][v]=u[c][2][v])}else break;11===u[c][0]&&c++;for(var A=c;c<u.length;c++)if(8===u[c][0]||5===u[c][0])E[1][T]?""===u[c][1]||(E[1][T]=i(E[1][T],u[c][1])):E[1][T]=a(u[c][1]);else if(0===u[c][0]&&(8===u[c][1]||5===u[c][1]))E[1][T]?""===u[c][2]||(E[1][T]=i(E[1][T],u[c][2])):E[1][T]=a(u[c][2]);else{T.length&&!E[1][T]&&c===A&&(3===u[c][0]||12===u[c][0])&&(E[1][T]=T.toLowerCase()),3===u[c][0]&&c--;break}}else if(5===_)E[1][d[1]]=!0;else if(0===_&&5===d[1])E[1][d[2]]=!0;else if(3===_){if(g=E[0],r.test(g)&&h.length){var b=h[h.length-1][1];h.pop(),h[h.length-1][0][2][b]=e(E[0],E[1],E[2].length?E[2]:void 0)}}else if(0===_&&1===d[1])void 0===d[2]||null===d[2]?d[2]="":d[2]||(d[2]=i("",d[2])),Array.isArray(d[2][0])?E[2].push.apply(E[2],d[2]):E[2].push(d[2]);else if(1===_)E[2].push(d[1]);else if(11===_||12===_);else throw Error("unhandled: "+_)}if(f[2].length>1&&/^\s*$/.test(f[2][0])&&f[2].shift(),f[2].length>2||2===f[2].length&&/\S/.test(f[2][1])){if(t.createFragment)return t.createFragment(f[2]);throw Error("multiple root elements must be wrapped in an enclosing tag")}return Array.isArray(f[2][0])&&"string"==typeof f[2][0][0]&&Array.isArray(f[2][0][2])&&(f[2][0]=e(f[2][0][0],f[2][0][1],f[2][0][2])),f[2][0];function N(e){var n=[];7===o&&(o=4);for(var r=0;r<e.length;r++){var i,a=e.charAt(r);1===o&&"<"===a?(l.length&&n.push([1,l]),l="",o=2):">"!==a||9===(i=o)||10===i||13===o?13===o&&/-$/.test(l)&&"-"===a?(t.comments&&n.push([8,l.substr(0,l.length-1)]),l="",o=1):2===o&&/^!--$/.test(l)?(t.comments&&n.push([2,l],[5,"comment"],[11]),l=a,o=13):1===o||13===o?l+=a:2===o&&"/"===a&&l.length||(2===o&&/\s/.test(a)?(l.length&&n.push([2,l]),l="",o=4):2===o?l+=a:4===o&&/[^\s"'=/]/.test(a)?(o=5,l=a):4===o&&/\s/.test(a)?(l.length&&n.push([5,l]),n.push([12])):5===o&&/\s/.test(a)?(n.push([5,l]),l="",o=6):5===o&&"="===a?(n.push([5,l],[11]),l="",o=7):5===o?l+=a:(6===o||4===o)&&"="===a?(n.push([11]),o=7):6!==o&&4!==o||/\s/.test(a)?7===o&&'"'===a?o=10:7===o&&"'"===a?o=9:10===o&&'"'===a?(n.push([8,l],[12]),l="",o=4):9===o&&"'"===a?(n.push([8,l],[12]),l="",o=4):7!==o||/\s/.test(a)?8===o&&/\s/.test(a)?(n.push([8,l],[12]),l="",o=4):(8===o||9===o||10===o)&&(l+=a):(o=8,r--):(n.push([12]),/[\w-]/.test(a)?(l+=a,o=5):o=4)):(2===o&&l.length?n.push([2,l]):5===o?n.push([5,l]):8===o&&l.length&&n.push([8,l]),n.push([3]),l="",o=1)}return 1===o&&l.length?(n.push([1,l]),l=""):8===o&&l.length?(n.push([8,l]),l=""):10===o&&l.length?(n.push([8,l]),l=""):9===o&&l.length?(n.push([8,l]),l=""):5===o&&(n.push([5,l]),l=""),n}};function a(e){return"function"==typeof e||"string"==typeof e?e:e&&"object"==typeof e?e:null==e?e:i("",e)}};var r=RegExp("^(area|base|basefont|bgsound|br|col|command|embed|frame|hr|img|input|isindex|keygen|link|meta|param|source|track|wbr|!--|animate|animateTransform|circle|cursor|desc|ellipse|feBlend|feColorMatrix|feComposite|feConvolveMatrix|feDiffuseLighting|feDisplacementMap|feDistantLight|feFlood|feFuncA|feFuncB|feFuncG|feFuncR|feGaussianBlur|feImage|feMergeNode|feMorphology|feOffset|fePointLight|feSpecularLighting|feSpotLight|feTile|feTurbulence|font-face-format|font-face-name|font-face-uri|glyph|glyphRef|hkern|image|line|missing-glyph|mpath|path|polygon|polyline|rect|set|stop|tref|use|view|vkern)(?:[.#][a-zA-Z0-9-￿_:-]+)*$")}),l("3Hulk",function(e,t){e.exports=function(e){return function(t,r,i){for(var a in r)a in n&&(r[n[a]]=r[a],delete r[a]);return e(t,r,i)}};var n={class:"className",for:"htmlFor","http-equiv":"httpEquiv"}}),l("dK39v",function(e,t){var n=/\n[\s]+$/,r=/^\n[\s]+/,i=/[\s]+$/,a=/^[\s]+/,o=/[\n\s]+/g,l=["a","abbr","b","bdi","bdo","br","cite","data","dfn","em","i","kbd","mark","q","rp","rt","rtc","ruby","s","amp","small","span","strong","sub","sup","time","u","var","wbr"],s=["code","pre","textarea"];e.exports=function e(t,u){if(Array.isArray(u))for(var c,m,d=t.nodeName.toLowerCase(),p=!1,f=0,h=u.length;f<h;f++){var g=u[f];if(Array.isArray(g)){e(t,g);continue}("number"==typeof g||"boolean"==typeof g||"function"==typeof g||g instanceof Date||g instanceof RegExp)&&(g=g.toString());var E=t.childNodes[t.childNodes.length-1];if("string"==typeof g)p=!0,E&&"#text"===E.nodeName?E.nodeValue+=g:(g=t.ownerDocument.createTextNode(g),t.appendChild(g),E=g),f===h-1&&(p=!1,-1===l.indexOf(d)&&-1===s.indexOf(d)?""===(c=E.nodeValue.replace(r,"").replace(i,"").replace(n,"").replace(o," "))?t.removeChild(E):E.nodeValue=c:-1===s.indexOf(d)&&(m=0===f?"":" ",c=E.nodeValue.replace(r,m).replace(a," ").replace(i,"").replace(n,"").replace(o," "),E.nodeValue=c));else if(g&&g.nodeType){p&&(p=!1,-1===l.indexOf(d)&&-1===s.indexOf(d)?""===(c=E.nodeValue.replace(r,"").replace(n," ").replace(o," "))?t.removeChild(E):E.nodeValue=c:-1===s.indexOf(d)&&(c=E.nodeValue.replace(a," ").replace(r,"").replace(n," ").replace(o," "),E.nodeValue=c));var _=g.nodeName;_&&(d=_.toLowerCase()),t.appendChild(g)}}}}),l("5GDNt",function(e,t){e.exports=["svg","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"]}),l("7s7aV",function(e,t){e.exports=["async","autofocus","autoplay","checked","controls","default","defaultchecked","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","novalidate","open","playsinline","readonly","required","reversed","selected"]}),l("1l1Xh",function(e,t){e.exports=["indeterminate"]}),o("kyEFX").register(new URL("",import.meta.url).toString(),JSON.parse('["l53ZJ","index.61ded116.js","1RELI","sprite.f5ef0385.svg"]'));var s=((n={}).nickname="nickname",n.datetime="datetime",n.avatar="avatar",n.replies="replies",n.default="default",n);class u{allowedTags;constructor(e=["b","i","u","s","small","mark","blockquote"]){this.allowedTags=new Set(e)}clean(e){if(!/<[a-z][\s\S]*>/i.test(e))return e;let t=new DOMParser().parseFromString(`<div>${e}</div>`,"text/html");if(!t.body)return e;let n=t.body.firstElementChild;return n?(this._clean(n,["div"]),n.innerHTML):e}_clean(e,t){if(e.nodeType===Node.ELEMENT_NODE){let n=e.tagName.toLowerCase();if(this.allowedTags.has(n)||t&&t.includes(n))Array.from(e.childNodes).forEach(e=>this._clean(e));else{let t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}}}}const c=e=>{let t=new Date(e);return{iso:t.toISOString(),humanized:m(t)}},m=(e=new Date)=>{let t=e.toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:e.getFullYear()!==new Date().getFullYear()?"numeric":void 0}),n=e.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return`${n}, ${t}`},d=(e,t)=>{e&&(e.hidden=t)},p=(e,t)=>{e&&(e.disabled=t)},f=(e,t)=>null!==e.getAttribute(t),h=(e,t,n)=>n?e.setAttribute(t,""):e.removeAttribute(t),g=(e,t)=>e.querySelector(t&&s.default!==t?`slot[name="${t}"]`:"slot:not([name])")??null,E=(e,t,n=s.default)=>(t instanceof HTMLElement&&n!=s.default&&t.setAttribute("slot",n),e.appendChild(t),t),_=()=>{let e=document.createElement("article");return e.setAttribute("aria-label","Комментарий"),e},b=()=>Object.fromEntries(Object.entries(s).map(([e])=>[e,null])),y=document.createElement("template");y.innerHTML=`
<style>
  :host {}

  .post-comment {}

  .post-comment__wrapper {}

  .post-comment__meta {
    font-size: 0.8rem;
    color: gray;
    display: flex;
    gap: 1rem;
  }

  .post-comment__avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    overflow: hidden;
    flex: none;
  }

  .post-comment__avatar img {
    object-fit: cover;
    width: 100%;
  }

  .post-comment__nickname :not(small) {
    font-weight: bold;
  }

  .post-comment__nickname+small {
    display: none;
  }

  .post-comment__nickname_current+small {
    display: initial;
  }

  .post-comment__content {
    width: 100%;
  }

  .post-comment__actions {
    margin-top: 0.5rem;
  }

  .post-comment__replies {
    margin-top: 1.5rem;
    margin-left: 2rem;
  }
</style>
<div class="post-comment">
  <div class="post-comment__wrapper">
    <div class="post-comment__meta">
      <div class="post-comment__avatar">
        <slot name="avatar">
          <img name="avatar" src="https://placehold.co/50" alt="\u{410}\u{432}\u{430}\u{442}\u{430}\u{440} \u{43F}\u{43E}\u{43B}\u{44C}\u{437}\u{43E}\u{432}\u{430}\u{442}\u{435}\u{43B}\u{44F} \u{43D}\u{435} \u{437}\u{430}\u{434}\u{430}\u{43D}" />
        </slot>
      </div>
      <div>
        <div>
          <span class="post-comment__nickname">
            <slot name="nickname">
              <strong aria-label="\u{41D}\u{438}\u{43A}\u{43D}\u{435}\u{439}\u{43C} \u{43F}\u{43E}\u{43B}\u{44C}\u{437}\u{43E}\u{432}\u{430}\u{442}\u{435}\u{43B}\u{44F}">\u{410}\u{43D}\u{43E}\u{43D}\u{438}\u{43C}\u{43D}\u{44B}\u{439} \u{43F}\u{43E}\u{43B}\u{44C}\u{437}\u{43E}\u{432}\u{430}\u{442}\u{435}\u{43B}\u{44C}</strong>
            </slot>
          </span>
          <small>(\u{44D}\u{442}\u{43E} \u{432}\u{44B})</small>
        </div>
        <div class="post-comment__datetime">
          <slot name="datetime">
            <time slot="datetime">\u{43D}\u{435}\u{438}\u{437}\u{432}\u{435}\u{441}\u{442}\u{43D}\u{43E}\u{435} \u{432}\u{440}\u{435}\u{43C}\u{44F}</time>
          </slot>
        </div>
      </div>
    </div>
    <div class="post-comment__content">
      <slot>
        <div aria-label="\u{422}\u{435}\u{43A}\u{441}\u{442} \u{43A}\u{43E}\u{43C}\u{43C}\u{435}\u{43D}\u{442}\u{430}\u{440}\u{438}\u{44F}"></div>
      </slot>
    </div>
  </div>
  <div class="post-comment__actions">
    <button class="post-comment__like-btn" aria-label="\u{41F}\u{43E}\u{441}\u{442}\u{430}\u{432}\u{438}\u{442}\u{44C} \u{43B}\u{430}\u{439}\u{43A}">
      \u{2764}\u{FE0F} <span class="post-comment__likes">0</span>
    </button>
    <button class="post-comment__reply-btn" aria-label="\u{41E}\u{442}\u{432}\u{435}\u{442}\u{438}\u{442}\u{44C} \u{43D}\u{430} \u{43A}\u{43E}\u{43C}\u{43C}\u{435}\u{43D}\u{442}\u{430}\u{440}\u{438}\u{439}">
      \u{41E}\u{442}\u{432}\u{435}\u{442}\u{438}\u{442}\u{44C}
    </button>
    <button class="post-comment__delete-btn" aria-label="\u{423}\u{434}\u{430}\u{43B}\u{438}\u{442}\u{44C} \u{43A}\u{43E}\u{43C}\u{43C}\u{435}\u{43D}\u{442}\u{430}\u{440}\u{438}\u{439}">
      \u{423}\u{434}\u{430}\u{43B}\u{438}\u{442}\u{44C}
    </button>
  </div>
  <div class="post-comment__replies">
    <slot name="replies">
      <section aria-label="\u{41E}\u{442}\u{432}\u{435}\u{442}\u{44B} \u{43D}\u{430} \u{43A}\u{43E}\u{43C}\u{43C}\u{435}\u{43D}\u{442}\u{430}\u{440}\u{438}\u{439}"></section>
    </slot>
  </div>
</div>`;class v extends HTMLElement{_initData;template;_wrapper;static COMPONENT_NAME="post-comment";static LIKE_EVENT_NAME=`${v.COMPONENT_NAME}-like`;static INTENT_REPLY_EVENT_NAME=`${v.COMPONENT_NAME}-intent-reply`;static DELETE_EVENT_NAME=`${v.COMPONENT_NAME}-delete`;static extTemplateId=`${v.COMPONENT_NAME}-template`;static avatarSize=50;static anonimusNickname="Анонимный пользователь";static anonimusAvatar=`https://placehold.co/${v.avatarSize}`;static _sanitizer=new u;_shadow;_liked;_deleted;_slotElemsWrappers;constructor(e,t=v._obtainTemplate(),n=_()){if(super(),this._initData=e,this.template=t,this._wrapper=n,this._shadow=null,this._liked=!1,this._deleted=!1,this._slotElemsWrappers=b(),this._initData){this.template??=y,this._prepareSlotElemsWrappers();let{id:e,user:{id:t,nickname:n=v.anonimusNickname,avatar:r=v.anonimusAvatar,current:i=!1},timestamp:a=Date.now(),text:o,likes:l=0,replies:s=[],granted:u=!1,deleted:c=!1}=this._initData;c?this.delete():(this._buildNicknameElement(n),this._buildAvatarElement(r),this._buildDatetimeElement(a),this._buildCommentTextElement(o),this.likes=l,this.replies=s.map(e=>{let t=this._wrapper?.cloneNode(!1);return new v(e,this.template,t)}),h(this,"granted",u),h(this,"by-current-user",i),this.dataset.id=e.toString(),this.dataset.userId=t.toString())}}static get observedAttributes(){return["likes","deleted"]}static get allowedTextTags(){return Array.from(v._sanitizer.allowedTags)}static set allowedTextTags(e){v._sanitizer.allowedTags=new Set(e)}get likes(){return Number(this.getAttribute("likes")??0)}set likes(e){this.setAttribute("likes",(e>0?e:0).toString())}get replies(){let e=this._getSlotElements(s.replies);return[...e?.filter(e=>e instanceof v)??[],...e?.filter(e=>!(e instanceof v))?.flatMap(e=>Array.from(e.querySelectorAll(v.COMPONENT_NAME)??[]))??[]]}set replies(e){if(!e.length){this._deleteSlotElements(s.replies);return}let t=document.createElement("template");t.content.append(...e),this._wrapElemAndInsert2slot(t.content,s.replies)}get deleted(){return this._deleted}get initData(){return this._initData}connectedCallback(){this.template??=y,this._wrapper&&this.parentNode&&this.parentNode!==this._wrapper&&(this.parentNode.insertBefore(this._wrapper,this),this._wrapper.appendChild(this)),this._shadow||(this._shadow=this.attachShadow({mode:"open"}),this._shadow.appendChild(this.template.content.cloneNode(!0)),this._attachEventListeners()),this._render()}attributeChangedCallback(){this._deleted||this._render()}addReply(e){this.replies.length?this._slotElemsWrappers[s.replies]?this._slotElemsWrappers[s.replies].appendChild(e):E(this,e,s.replies):this.replies=[e]}delete(){h(this,"deleted",!0)}_render(){if(!this._shadow)return;if(f(this,"deleted")){this._delete();return}d(this._getElement("delete-btn"),!f(this,"granted")),this._getElement("likes")?.replaceChildren(document.createTextNode(this.getAttribute("likes")??"0"));let e=this._getElement("like-btn");this._getElement("nickname")?.classList.toggle(v._getElemModifCssCls("nickname","current"),f(this,"by-current-user")),f(this,"by-current-user")&&p(e,!0)}_attachEventListeners(){this._getElement("like-btn")?.addEventListener("click",()=>this._handleLike()),this._getElement("reply-btn")?.addEventListener("click",()=>this._handleReply()),this._getElement("delete-btn")?.addEventListener("click",()=>this._handleDelete())}_handleLike(){let e=this._getElement("like-btn");if(!this._liked){let t=Number(this.getAttribute("likes")??0)+1;this.setAttribute("likes",String(t)),this._getElement("likes")?.replaceChildren(document.createTextNode(String(t))),this.dispatchEvent(new CustomEvent(v.LIKE_EVENT_NAME,{bubbles:!0,composed:!0,detail:{likes:t}})),p(e,!0)}}_handleReply(){this.dispatchEvent(new CustomEvent(v.INTENT_REPLY_EVENT_NAME,{bubbles:!0,composed:!0,detail:{comment:this}}))}_handleDelete(){this.delete(),this.dispatchEvent(new CustomEvent(v.DELETE_EVENT_NAME,{bubbles:!0,composed:!0,detail:{comment:this}}))}_delete(){Object.entries(s).forEach(([e,t])=>{let n=this._getSlot(t);t===s.default?(n?.replaceWith("Комментарий удален"),this._deleteSlotElements(t)):t!==s.replies&&(n?.remove(),this._deleteSlotElements(t))}),this._getElement("meta")?.remove(),this._getElement("actions")?.remove(),Array.from(this.attributes).forEach(({name:e})=>{"deleted"!==e&&this.removeAttribute(e)}),this._deleted=!0}static _obtainTemplate(){return document.querySelector(`template#${v.extTemplateId}`)}_buildNicknameElement(e){this._wrapElemAndInsert2slot(e,s.nickname)}_buildAvatarElement(e){let t;let n=this._getSlotElemWrapper(s.avatar);n instanceof HTMLImageElement?t=n:(t=document.createElement("img"),n?n.replaceChildren(t):n=t),t.src=e,E(this,n,s.avatar)}_buildDatetimeElement(e){let{iso:t,humanized:n}=c(e),r=this._wrapElemAndInsert2slot(n,s.datetime);r instanceof HTMLTimeElement&&r.setAttribute("datetime",t)}_buildCommentTextElement(e){let t=document.createElement("template");t.innerHTML=v._sanitizer.clean(e),this._wrapElemAndInsert2slot(t.content)}_wrapElemAndInsert2slot(e,t=s.default){return E(this,this._wrapSlotElement(e,t),t)}_wrapSlotElement(e,t=s.default){let n=this._getSlotElemWrapper(t);if(n)n.replaceChildren(e);else{if(e instanceof HTMLElement||e instanceof DocumentFragment)return e;(n=document.createElement("div")).append(e),this._slotElemsWrappers[t]=n}return n}_getSlotElemWrapper(e){return this._slotElemsWrappers[e]}_prepareSlotElemsWrappers(){let e;if(this.template)for(e in this._slotElemsWrappers){let t=this._getSlotTemplate(e);t&&(this._slotElemsWrappers[e]=t.children.item(0)?.cloneNode(!1))}}_getSlot(e){return this._shadow?g(this._shadow,e):null}_getSlotElements(e,t=!1){return this._getSlot(e)?.assignedElements({flatten:t})??null}_deleteSlotElements(e){return this._getSlotElements(e)?.forEach(e=>e.remove())}_getSlotTemplate(e){return this.template?g(this.template.content,e):null}_getElement(e){return this._shadow?.querySelector(`.${v._getElemCssCls(e)}`)??null}static _getElemCssCls(e){return`${v.COMPONENT_NAME}__${e}`}static _getElemModifCssCls(e,t){return`${v._getElemCssCls(e)}_${t}`}}const T="comment-input";function A(e){let t=e.target,n=t.closest("form");if(n){let e=n.querySelector('button:not([type="reset"])');if(t){let r=t.value.trim(),i=Number(t.getAttribute("minlength")??0),a=Number(t.getAttribute("maxlength")??1/0);n.dispatchEvent(new CustomEvent(T,{detail:{filled:r.length>0}})),p(e,r.length<i||r.length>a)}}}var N={};N=function(){let{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:r,getOwnPropertyDescriptor:i}=Object,{freeze:a,seal:o,create:l}=Object,{apply:s,construct:u}="undefined"!=typeof Reflect&&Reflect;a||(a=function(e){return e}),o||(o=function(e){return e}),s||(s=function(e,t,n){return e.apply(t,n)}),u||(u=function(e,t){return new e(...t)});let c=N(Array.prototype.forEach),m=N(Array.prototype.lastIndexOf),d=N(Array.prototype.pop),p=N(Array.prototype.push),f=N(Array.prototype.splice),h=N(String.prototype.toLowerCase),g=N(String.prototype.toString),E=N(String.prototype.match),_=N(String.prototype.replace),b=N(String.prototype.indexOf),y=N(String.prototype.trim),v=N(Object.prototype.hasOwnProperty),T=N(RegExp.prototype.test),A=(Y=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(Y,t)});function N(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return s(e,t,r)}}function S(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;t&&t(e,null);let a=r.length;for(;a--;){let t=r[a];if("string"==typeof t){let e=i(t);e!==t&&(n(r)||(r[a]=e),t=e)}e[t]=!0}return e}function w(t){let n=l(null);for(let[r,i]of e(t))v(t,r)&&(Array.isArray(i)?n[r]=function(e){for(let t=0;t<e.length;t++)v(e,t)||(e[t]=null);return e}(i):i&&"object"==typeof i&&i.constructor===Object?n[r]=w(i):n[r]=i);return n}function C(e,t){for(;null!==e;){let n=i(e,t);if(n){if(n.get)return N(n.get);if("function"==typeof n.value)return N(n.value)}e=r(e)}return function(){return null}}let k=a(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=a(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),x=a(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=a(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),O=a(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),M=a(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),R=a(["#text"]),I=a(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),F=a(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),P=a(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=a(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=o(/<%[\w\W]*|[\w\W]*%>/gm),B=o(/\$\{[\w\W]*/gm),W=o(/^data-[\-\w.\u00B7-\uFFFF]+$/),$=o(/^aria-[\-\w]+$/),G=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q=o(/^(?:\w+script|data):/i),j=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),V=o(/^html$/i);var Y,X=Object.freeze({__proto__:null,ARIA_ATTR:$,ATTR_WHITESPACE:j,CUSTOM_ELEMENT:o(/^[a-z][.\w]*(-[.\w]+)+$/i),DATA_ATTR:W,DOCTYPE_NAME:V,ERB_EXPR:z,IS_ALLOWED_URI:G,IS_SCRIPT_OR_DATA:q,MUSTACHE_EXPR:H,TMPLIT_EXPR:B});let K={element:1,text:3,progressingInstruction:7,comment:8,document:9},J=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null,r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));let i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Z=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};return function t(){let n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,i=e=>t(e);if(i.version="3.2.4",i.removed=[],!r||!r.document||r.document.nodeType!==K.document||!r.Element)return i.isSupported=!1,i;let{document:o}=r,s=o,u=s.currentScript,{DocumentFragment:N,HTMLTemplateElement:H,Node:z,Element:B,NodeFilter:W,NamedNodeMap:$=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:q,DOMParser:j,trustedTypes:Y}=r,Q=B.prototype,ee=C(Q,"cloneNode"),et=C(Q,"remove"),en=C(Q,"nextSibling"),er=C(Q,"childNodes"),ei=C(Q,"parentNode");if("function"==typeof H){let e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let ea="",{implementation:eo,createNodeIterator:el,createDocumentFragment:es,getElementsByTagName:eu}=o,{importNode:ec}=s,em=Z();i.isSupported="function"==typeof e&&"function"==typeof ei&&eo&&void 0!==eo.createHTMLDocument;let{MUSTACHE_EXPR:ed,ERB_EXPR:ep,TMPLIT_EXPR:ef,DATA_ATTR:eh,ARIA_ATTR:eg,IS_SCRIPT_OR_DATA:eE,ATTR_WHITESPACE:e_,CUSTOM_ELEMENT:eb}=X,{IS_ALLOWED_URI:ey}=X,ev=null,eT=S({},[...k,...L,...x,...O,...R]),eA=null,eN=S({},[...I,...F,...P,...U]),eS=Object.seal(l(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ew=null,eC=null,ek=!0,eL=!0,ex=!1,eD=!0,eO=!1,eM=!0,eR=!1,eI=!1,eF=!1,eP=!1,eU=!1,eH=!1,ez=!0,eB=!1,eW=!0,e$=!1,eG={},eq=null,ej=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eV=null,eY=S({},["audio","video","img","source","image","track"]),eX=null,eK=S({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),eJ="http://www.w3.org/1998/Math/MathML",eZ="http://www.w3.org/2000/svg",eQ="http://www.w3.org/1999/xhtml",e0=eQ,e4=!1,e1=null,e3=S({},[eJ,eZ,eQ],g),e2=S({},["mi","mo","mn","ms","mtext"]),e5=S({},["annotation-xml"]),e8=S({},["title","style","font","a","script"]),e9=null,e7=["application/xhtml+xml","text/html"],e6=null,te=null,tt=o.createElement("form"),tn=function(e){return e instanceof RegExp||e instanceof Function},tr=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!te||te!==e){if(e&&"object"==typeof e||(e={}),e=w(e),e6="application/xhtml+xml"===(e9=-1===e7.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?g:h,ev=v(e,"ALLOWED_TAGS")?S({},e.ALLOWED_TAGS,e6):eT,eA=v(e,"ALLOWED_ATTR")?S({},e.ALLOWED_ATTR,e6):eN,e1=v(e,"ALLOWED_NAMESPACES")?S({},e.ALLOWED_NAMESPACES,g):e3,eX=v(e,"ADD_URI_SAFE_ATTR")?S(w(eK),e.ADD_URI_SAFE_ATTR,e6):eK,eV=v(e,"ADD_DATA_URI_TAGS")?S(w(eY),e.ADD_DATA_URI_TAGS,e6):eY,eq=v(e,"FORBID_CONTENTS")?S({},e.FORBID_CONTENTS,e6):ej,ew=v(e,"FORBID_TAGS")?S({},e.FORBID_TAGS,e6):{},eC=v(e,"FORBID_ATTR")?S({},e.FORBID_ATTR,e6):{},eG=!!v(e,"USE_PROFILES")&&e.USE_PROFILES,ek=!1!==e.ALLOW_ARIA_ATTR,eL=!1!==e.ALLOW_DATA_ATTR,ex=e.ALLOW_UNKNOWN_PROTOCOLS||!1,eD=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,eO=e.SAFE_FOR_TEMPLATES||!1,eM=!1!==e.SAFE_FOR_XML,eR=e.WHOLE_DOCUMENT||!1,eP=e.RETURN_DOM||!1,eU=e.RETURN_DOM_FRAGMENT||!1,eH=e.RETURN_TRUSTED_TYPE||!1,eF=e.FORCE_BODY||!1,ez=!1!==e.SANITIZE_DOM,eB=e.SANITIZE_NAMED_PROPS||!1,eW=!1!==e.KEEP_CONTENT,e$=e.IN_PLACE||!1,ey=e.ALLOWED_URI_REGEXP||G,e0=e.NAMESPACE||eQ,e2=e.MATHML_TEXT_INTEGRATION_POINTS||e2,e5=e.HTML_INTEGRATION_POINTS||e5,eS=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&tn(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(eS.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&tn(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(eS.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(eS.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eO&&(eL=!1),eU&&(eP=!0),eG&&(ev=S({},R),eA=[],!0===eG.html&&(S(ev,k),S(eA,I)),!0===eG.svg&&(S(ev,L),S(eA,F),S(eA,U)),!0===eG.svgFilters&&(S(ev,x),S(eA,F),S(eA,U)),!0===eG.mathMl&&(S(ev,O),S(eA,P),S(eA,U))),e.ADD_TAGS&&(ev===eT&&(ev=w(ev)),S(ev,e.ADD_TAGS,e6)),e.ADD_ATTR&&(eA===eN&&(eA=w(eA)),S(eA,e.ADD_ATTR,e6)),e.ADD_URI_SAFE_ATTR&&S(eX,e.ADD_URI_SAFE_ATTR,e6),e.FORBID_CONTENTS&&(eq===ej&&(eq=w(eq)),S(eq,e.FORBID_CONTENTS,e6)),eW&&(ev["#text"]=!0),eR&&S(ev,["html","head","body"]),ev.table&&(S(ev,["tbody"]),delete ew.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw A('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw A('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ea=(n=e.TRUSTED_TYPES_POLICY).createHTML("")}else void 0===n&&(n=J(Y,u)),null!==n&&"string"==typeof ea&&(ea=n.createHTML(""));a&&a(e),te=e}},ti=S({},[...L,...x,...D]),ta=S({},[...O,...M]),to=function(e){let t=ei(e);t&&t.tagName||(t={namespaceURI:e0,tagName:"template"});let n=h(e.tagName),r=h(t.tagName);return!!e1[e.namespaceURI]&&(e.namespaceURI===eZ?t.namespaceURI===eQ?"svg"===n:t.namespaceURI===eJ?"svg"===n&&("annotation-xml"===r||e2[r]):!!ti[n]:e.namespaceURI===eJ?t.namespaceURI===eQ?"math"===n:t.namespaceURI===eZ?"math"===n&&e5[r]:!!ta[n]:e.namespaceURI===eQ?(t.namespaceURI!==eZ||!!e5[r])&&(t.namespaceURI!==eJ||!!e2[r])&&!ta[n]&&(e8[n]||!ti[n]):"application/xhtml+xml"===e9&&!!e1[e.namespaceURI])},tl=function(e){p(i.removed,{element:e});try{ei(e).removeChild(e)}catch(t){et(e)}},ts=function(e,t){try{p(i.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){p(i.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e){if(eP||eU)try{tl(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},tu=function(e){let t=null,r=null;if(eF)e="<remove></remove>"+e;else{let t=E(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===e9&&e0===eQ&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");let i=n?n.createHTML(e):e;if(e0===eQ)try{t=new j().parseFromString(i,e9)}catch(e){}if(!t||!t.documentElement){t=eo.createDocument(e0,"template",null);try{t.documentElement.innerHTML=e4?ea:i}catch(e){}}let a=t.body||t.documentElement;return(e&&r&&a.insertBefore(o.createTextNode(r),a.childNodes[0]||null),e0===eQ)?eu.call(t,eR?"html":"body")[0]:eR?t.documentElement:a},tc=function(e){return el.call(e.ownerDocument||e,e,W.SHOW_ELEMENT|W.SHOW_COMMENT|W.SHOW_TEXT|W.SHOW_PROCESSING_INSTRUCTION|W.SHOW_CDATA_SECTION,null)},tm=function(e){return e instanceof q&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof $)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},td=function(e){return"function"==typeof z&&e instanceof z};function tp(e,t,n){c(e,e=>{e.call(i,t,n,te)})}let tf=function(e){let t=null;if(tp(em.beforeSanitizeElements,e,null),tm(e))return tl(e),!0;let n=e6(e.nodeName);if(tp(em.uponSanitizeElement,e,{tagName:n,allowedTags:ev}),e.hasChildNodes()&&!td(e.firstElementChild)&&T(/<[/\w]/g,e.innerHTML)&&T(/<[/\w]/g,e.textContent)||e.nodeType===K.progressingInstruction||eM&&e.nodeType===K.comment&&T(/<[/\w]/g,e.data))return tl(e),!0;if(!ev[n]||ew[n]){if(!ew[n]&&tg(n)&&(eS.tagNameCheck instanceof RegExp&&T(eS.tagNameCheck,n)||eS.tagNameCheck instanceof Function&&eS.tagNameCheck(n)))return!1;if(eW&&!eq[n]){let t=ei(e)||e.parentNode,n=er(e)||e.childNodes;if(n&&t){let r=n.length;for(let i=r-1;i>=0;--i){let r=ee(n[i],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,en(e))}}}return tl(e),!0}return e instanceof B&&!to(e)||("noscript"===n||"noembed"===n||"noframes"===n)&&T(/<\/no(script|embed|frames)/i,e.innerHTML)?(tl(e),!0):(eO&&e.nodeType===K.text&&(t=e.textContent,c([ed,ep,ef],e=>{t=_(t,e," ")}),e.textContent!==t&&(p(i.removed,{element:e.cloneNode()}),e.textContent=t)),tp(em.afterSanitizeElements,e,null),!1)},th=function(e,t,n){if(ez&&("id"===t||"name"===t)&&(n in o||n in tt))return!1;if(eL&&!eC[t]&&T(eh,t));else if(ek&&T(eg,t));else if(!eA[t]||eC[t]){if(!(tg(e)&&(eS.tagNameCheck instanceof RegExp&&T(eS.tagNameCheck,e)||eS.tagNameCheck instanceof Function&&eS.tagNameCheck(e))&&(eS.attributeNameCheck instanceof RegExp&&T(eS.attributeNameCheck,t)||eS.attributeNameCheck instanceof Function&&eS.attributeNameCheck(t))||"is"===t&&eS.allowCustomizedBuiltInElements&&(eS.tagNameCheck instanceof RegExp&&T(eS.tagNameCheck,n)||eS.tagNameCheck instanceof Function&&eS.tagNameCheck(n))))return!1}else if(eX[t]);else if(T(ey,_(n,e_,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===b(n,"data:")&&eV[e]);else if(ex&&!T(eE,_(n,e_,"")));else if(n)return!1;return!0},tg=function(e){return"annotation-xml"!==e&&E(e,eb)},tE=function(e){tp(em.beforeSanitizeAttributes,e,null);let{attributes:t}=e;if(!t||tm(e))return;let r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:eA,forceKeepAttr:void 0},a=t.length;for(;a--;){let{name:o,namespaceURI:l,value:s}=t[a],u=e6(o),m="value"===o?s:y(s);if(r.attrName=u,r.attrValue=m,r.keepAttr=!0,r.forceKeepAttr=void 0,tp(em.uponSanitizeAttribute,e,r),m=r.attrValue,eB&&("id"===u||"name"===u)&&(ts(o,e),m="user-content-"+m),eM&&T(/((--!?|])>)|<\/(style|title)/i,m)){ts(o,e);continue}if(r.forceKeepAttr||(ts(o,e),!r.keepAttr))continue;if(!eD&&T(/\/>/i,m)){ts(o,e);continue}eO&&c([ed,ep,ef],e=>{m=_(m,e," ")});let p=e6(e.nodeName);if(th(p,u,m)){if(n&&"object"==typeof Y&&"function"==typeof Y.getAttributeType){if(l);else switch(Y.getAttributeType(p,u)){case"TrustedHTML":m=n.createHTML(m);break;case"TrustedScriptURL":m=n.createScriptURL(m)}}try{l?e.setAttributeNS(l,o,m):e.setAttribute(o,m),tm(e)?tl(e):d(i.removed)}catch(e){}}}tp(em.afterSanitizeAttributes,e,null)},t_=function e(t){let n=null,r=tc(t);for(tp(em.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)tp(em.uponSanitizeShadowNode,n,null),tf(n),tE(n),n.content instanceof N&&e(n.content);tp(em.afterSanitizeShadowDOM,t,null)};return i.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,a=null,o=null,l=null;if((e4=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!td(e)){if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw A("dirty is not a string, aborting")}else throw A("toString is not a function")}if(!i.isSupported)return e;if(eI||tr(t),i.removed=[],"string"==typeof e&&(e$=!1),e$){if(e.nodeName){let t=e6(e.nodeName);if(!ev[t]||ew[t])throw A("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof z)(a=(r=tu("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType===K.element&&"BODY"===a.nodeName?r=a:"HTML"===a.nodeName?r=a:r.appendChild(a);else{if(!eP&&!eO&&!eR&&-1===e.indexOf("<"))return n&&eH?n.createHTML(e):e;if(!(r=tu(e)))return eP?null:eH?ea:""}r&&eF&&tl(r.firstChild);let u=tc(e$?e:r);for(;o=u.nextNode();)tf(o),tE(o),o.content instanceof N&&t_(o.content);if(e$)return e;if(eP){if(eU)for(l=es.call(r.ownerDocument);r.firstChild;)l.appendChild(r.firstChild);else l=r;return(eA.shadowroot||eA.shadowrootmode)&&(l=ec.call(s,l,!0)),l}let m=eR?r.outerHTML:r.innerHTML;return eR&&ev["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&T(V,r.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+m),eO&&c([ed,ep,ef],e=>{m=_(m,e," ")}),n&&eH?n.createHTML(m):m},i.setConfig=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};tr(e),eI=!0},i.clearConfig=function(){te=null,eI=!1},i.isValidAttribute=function(e,t,n){return te||tr({}),th(e6(e),e6(t),n)},i.addHook=function(e,t){"function"==typeof t&&p(em[e],t)},i.removeHook=function(e,t){if(void 0!==t){let n=m(em[e],t);return -1===n?void 0:f(em[e],n,1)[0]}return d(em[e])},i.removeHooks=function(e){em[e]=[]},i.removeAllHooks=function(){em=Z()},i}()}();var S={};S=o("jeOj9")(document);var w={};w=function(e){var t,n=document.createElement("div");return n.innerHTML=e,Array.isArray(t=n.childNodes)?t:[].slice.call(t)};var C={};C=JSON.parse('[{"id":101,"nickname":"BluePill","current":true},{"id":102,"nickname":"~юный~скуф~"},{"id":103,"nickname":"P0w3r"},{"id":104,"nickname":"Симулякр"}]');var k={};k=JSON.parse('[{"id":1001,"user":101,"timestamp":1740563333000,"text":"Тетрис?","likes":0,"replies":[{"id":1002,"user":102,"timestamp":1740563550000,"text":"Нееее","likes":0,"replies":[]},{"id":1003,"user":104,"timestamp":1740563598000,"text":"Хм, ну нет... <small>(а похоже)</small>","likes":1,"replies":[]},{"id":1004,"user":101,"timestamp":1740563625000,"text":"Удаленный комментарий","deleted":true}]},{"id":1005,"user":101,"timestamp":1740563672000,"text":"A Quiet Place: The Road Ahead?","likes":4,"replies":[{"id":1006,"user":102,"timestamp":1740563714000,"text":"Да!","likes":2,"replies":[{"id":1007,"user":103,"timestamp":1740563823000,"text":"Был уверен что <u>The Quarry</u>(","likes":1}]}]}]');const L=t(C).map(({id:t,nickname:n,avatar:r,current:i})=>({id:t,nickname:n,avatar:r??function(e,t=v.avatarSize){let n=new URL("https://api.dicebear.com/9.x/avataaars/png"),r=new URLSearchParams({seed:e,backgroundColor:"0172ad",size:t.toString()});return n.search=r.toString(),n.toString()}(n),current:!!(i&&!e&&(e=t))})),x=L.filter(({current:e})=>e)?.[0],D=function e(t){return t.map(({id:t,user:n,timestamp:r,text:i,likes:a,replies:o,granted:l,deleted:s})=>({id:t,user:L.find(({id:e})=>e.toString()===n.toString())??O(),timestamp:r,text:i,likes:a,replies:o?e(o):void 0,granted:l||x?.id.toString()===String(n),deleted:s}))}(t(k));function O(){return{id:Date.now(),nickname:v.anonimusNickname,avatar:v.anonimusAvatar,current:!1}}const M="comment-published";var R={};function I(e,n=document.body,r){if(e||(e=t(S)` <form>
      <textarea
        placeholder="Написать комментарий..."
        required
        minlength="1"
        maxlength="1024"
      ></textarea>
      <button disabled>
        <svg>
          <use href="${t(R)}#airplane" />
        </svg>
        <span>Отправить</span>
      </button>
      ${t(w)(" ")}
      <button type="reset">
        <svg>
          <use href="${t(R)}#cross" />
        </svg>
        <span>Отменить</span>
      </button>
    </form>`,(r??n).prepend(e)),e._addCommentOnSubmit||(e._addCommentOnSubmit=e=>(function(e,n){e.preventDefault();let r=e.target,i=r?.querySelector("textarea");if(i){let e=i.value.trim();i.value="",i.dispatchEvent(new Event("input"));let a=function(){let{nickname:e=v.anonimusNickname,avatar:t=v.anonimusAvatar}=x||O();return{userId:x?.id,nickname:e,avatar:t,datetime:c(Date.now()),current:!0}}(),o=function({meta:{nickname:e,avatar:n,datetime:r,current:i},text:a,likes:o,granted:l,deleted:s},u){let{humanized:c,iso:m}="string"==typeof r?{humanized:r}:r,d=t(S)` <post-comment
    ${o?{likes:o}:{}}
    ${l?{granted:""}:{}}
    ${s?{deleted:""}:{}}
    ${i?{"by-current-user":""}:{}}
  >
    <time slot="datetime" ${m?{datetime:m}:{}}>
      ${c}
    </time>
    <strong slot="nickname" aria-label="Никнейм пользователя"
      >${e}</strong
    >
    <img slot="avatar" src="${n}" alt="Аватар пользователя ${e}" />
    <div aria-label="Текст комментария">${t(w)(a)}</div>
  </post-comment>`;return u.appendChild(d),d}({id:Date.now(),meta:a,text:t(N).sanitize(e,{ALLOWED_TAGS:["b","i","u","s","small","mark","blockquote","img"],ALLOWED_ATTR:["src","alt"],FORBID_ATTR:["onerror","onload"]}),granted:void 0!==a.userId},n);r.dispatchEvent(new CustomEvent(M,{bubbles:!0,composed:!0,detail:{comment:o}}))}})(e,n)),!e._onReset){let t=e.querySelector('button:not([type="reset"])');e._onReset=()=>p(t,!0)}return e.addEventListener("submit",e._addCommentOnSubmit),e.addEventListener("reset",e._onReset),e.querySelector("textarea")?.addEventListener("input",A),e}R=new URL("sprite.f5ef0385.svg",import.meta.url).toString();const F=e=>console.log("comment likes count",e.detail.likes),P=e=>e.scrollIntoView({behavior:"smooth",block:"start"});customElements.define(v.COMPONENT_NAME,v),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("post-comments-tread");if(e){let n=I(document.getElementById("add-comment-form"),e),r=n?.querySelector('button[type="reset"]');r&&(r.hidden=!0,n.addEventListener(T,e=>{let{detail:{filled:t}}=e;r.hidden=!t}),n.addEventListener("reset",()=>r.hidden=!0),n.addEventListener(M,e=>{let{detail:{comment:t}}=e;P(t)})),e.addEventListener(v.LIKE_EVENT_NAME,e=>F(e)),e.addEventListener(v.INTENT_REPLY_EVENT_NAME,e=>(function({detail:e}){let{comment:n}=e;console.log("intent to reply on comment",n);let r=n.querySelector('[slot="replies"]');r||(r=t(S)`<section
      slot="replies"
      aria-label="Ответы на комментарий"
    />`,n.appendChild(r));let i=n.querySelector("form");(i=I(i,r)).hidden=!1,i._resetFormHandler||(i._hideForm=()=>i.hidden=!0),i.addEventListener("reset",i._hideForm),i.addEventListener("submit",i._hideForm)})(e)),e.addEventListener(v.DELETE_EVENT_NAME,e=>(function({detail:e}){let{comment:t}=e;console.log("deleted comment",t);let n=t.querySelector(':scope > [slot="replies"] > form');n?.remove()})(e)),document.getElementById("add-comment-by-api")?.addEventListener("click",t=>{let n=!1;D.forEach(t=>{let r=new v(t);e.append(r),n||(P(r),n=!0)}),p(t.target,!0)})}});
//# sourceMappingURL=index.61ded116.js.map
